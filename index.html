<!DOCTYPE html>
<html>
<head>
		<style>
			body { margin:0; padding:0; }
			#wp { width: 100vw; height: 100vw; border: none; }
		</style>
</head>
<body>
<iframe class="wp-playground" id="wp"></iframe>
<script type="module">
  import { startPlaygroundWeb } from "https://unpkg.com/@wp-playground/client/index.js";

  let blueprint = {
    "$schema": "https:\/\/playground.wordpress.net\/blueprint-schema.json",
    "landingPage": "\/",
    "preferredVersions": {
        "php": "8.0",
        "wp": "latest"
    },
    "steps": [
        {
            "step": "login",
            "username": "admin",
            "password": "password"
        },
        {
            "step": "installPlugin",
            "pluginZipFile": {
                "resource": "wordpress.org\/plugins",
                "slug": "pods"
            },
            "options": {
                "activate": true
            }
        }
    ]
};

  blueprint.steps.push({
  	"step": 'runPHP',
  	"code": atob( 'PD9waHAKCmluY2x1ZGUgJ3dvcmRwcmVzcy93cC1sb2FkLnBocCc7Cmdsb2JhbCAkd3BkYjsKCm9iX3N0YXJ0KCk7Cj8+ewogICAgIkBtZXRhIjogewogICAgICAgICJ2ZXJzaW9uIjogIjIuOS4xOSIsCiAgICAgICAgImJ1aWxkIjogMTY5MDgyODUxOAogICAgfSwKICAgICJzZXR0aW5ncyI6IHsKICAgICAgICAidHlwZXNfb25seSI6ICIwIiwKICAgICAgICAid2F0Y2hfY2hhbmdlZF9maWVsZHMiOiAiMCIsCiAgICAgICAgIm1ldGFkYXRhX2ludGVncmF0aW9uIjogIjEiLAogICAgICAgICJtZXRhZGF0YV9vdmVycmlkZV9nZXQiOiAiMCIsCiAgICAgICAgIm1lZGlhX21vZGFsX2ZpZWxkcyI6ICIwIiwKICAgICAgICAic2Vzc2lvbl9hdXRvX3N0YXJ0IjogIjAiLAogICAgICAgICJ3aXNkb21fb3B0X291dCI6ICIxIgogICAgfSwKICAgICJwb2RzIjogWwogICAgICAgIHsKICAgICAgICAgICAgIm5hbWUiOiAiYm9va19hdXRob3IiLAogICAgICAgICAgICAiaWQiOiAxMywKICAgICAgICAgICAgImxhYmVsIjogIkJvb2sgQXV0aG9ycyIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICIiLAogICAgICAgICAgICAidHlwZSI6ICJ0YXhvbm9teSIsCiAgICAgICAgICAgICJzdG9yYWdlIjogIm1ldGEiLAogICAgICAgICAgICAibGFiZWxfc2luZ3VsYXIiOiAiQm9vayBBdXRob3IiLAogICAgICAgICAgICAicHVibGljIjogIjEiLAogICAgICAgICAgICAic2hvd191aSI6ICIxIiwKICAgICAgICAgICAgImhpZXJhcmNoaWNhbCI6ICIxIiwKICAgICAgICAgICAgInJlc3RfZW5hYmxlIjogIjEiLAogICAgICAgICAgICAiX21pZ3JhdGVkXzI4IjogIjEiLAogICAgICAgICAgICAiYnVpbHRfaW5fcG9zdF90eXBlc19ib29rIjogIjEiLAogICAgICAgICAgICAiZ3JvdXBzIjogWwogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogImJvb2tfYXV0aG9yX2luZm8iLAogICAgICAgICAgICAgICAgICAgICJpZCI6IDE0LAogICAgICAgICAgICAgICAgICAgICJsYWJlbCI6ICJCb29rIEF1dGhvciBJbmZvIiwKICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAid2VpZ2h0IjogMCwKICAgICAgICAgICAgICAgICAgICAicm9sZXNfYWxsb3dlZCI6ICJhZG1pbmlzdHJhdG9yIiwKICAgICAgICAgICAgICAgICAgICAiZmllbGRzIjogW10KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgXQogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICAibmFtZSI6ICJib29rIiwKICAgICAgICAgICAgImlkIjogMTAsCiAgICAgICAgICAgICJsYWJlbCI6ICJCb29rcyIsCiAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICIiLAogICAgICAgICAgICAidHlwZSI6ICJwb3N0X3R5cGUiLAogICAgICAgICAgICAic3RvcmFnZSI6ICJtZXRhIiwKICAgICAgICAgICAgImxhYmVsX3Npbmd1bGFyIjogIkJvb2siLAogICAgICAgICAgICAicHVibGljIjogIjEiLAogICAgICAgICAgICAic2hvd191aSI6ICIxIiwKICAgICAgICAgICAgInJlc3RfZW5hYmxlIjogIjEiLAogICAgICAgICAgICAic3VwcG9ydHNfdGl0bGUiOiAiMSIsCiAgICAgICAgICAgICJzdXBwb3J0c19lZGl0b3IiOiAiMSIsCiAgICAgICAgICAgICJfbWlncmF0ZWRfMjgiOiAiMSIsCiAgICAgICAgICAgICJtZXRhX2JveF9jb250ZXh0IjogIm5vcm1hbCIsCiAgICAgICAgICAgICJtZXRhX2JveF9wcmlvcml0eSI6ICJkZWZhdWx0IiwKICAgICAgICAgICAgInJlcXVpcmVkIjogIjAiLAogICAgICAgICAgICAicmVxdWlyZWRfaGVscF9ib29sZWFuIjogIjAiLAogICAgICAgICAgICAiYnVpbHRfaW5fdGF4b25vbWllc19ib29rX2F1dGhvciI6ICIxIiwKICAgICAgICAgICAgImdyb3VwcyI6IFsKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJib29rX2luZm8iLAogICAgICAgICAgICAgICAgICAgICJpZCI6IDExLAogICAgICAgICAgICAgICAgICAgICJsYWJlbCI6ICJCb29rIEluZm8iLAogICAgICAgICAgICAgICAgICAgICJkZXNjcmlwdGlvbiI6ICIiLAogICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAwLAogICAgICAgICAgICAgICAgICAgICJtZXRhX2JveF9jb250ZXh0IjogIm5vcm1hbCIsCiAgICAgICAgICAgICAgICAgICAgIm1ldGFfYm94X3ByaW9yaXR5IjogImRlZmF1bHQiLAogICAgICAgICAgICAgICAgICAgICJyb2xlc19hbGxvd2VkIjogImFkbWluaXN0cmF0b3IiLAogICAgICAgICAgICAgICAgICAgICJmaWVsZHMiOiBbCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJuYW1lIjogImlzYm4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImlkIjogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAibGFiZWwiOiAiSVNCTiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZGVzY3JpcHRpb24iOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3ZWlnaHQiOiAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInR5cGUiOiAidGV4dCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAic2lzdGVyX2lkIjogIi0tIFNlbGVjdCBPbmUgLS0iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInJlcXVpcmVkIjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInJlcXVpcmVkX2hlbHBfYm9vbGVhbiI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ0ZXh0X2FsbG93ZWRfaHRtbF90YWdzIjogInN0cm9uZyBlbSBhIHVsIG9sIGxpIGIgaSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAidGV4dF9tYXhfbGVuZ3RoIjogIjI1NSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicmVwZWF0YWJsZSI6ICIwIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJyZXBlYXRhYmxlX2Zvcm1hdCI6ICJkZWZhdWx0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICJyb2xlc19hbGxvd2VkIjogImFkbWluaXN0cmF0b3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgInJlc3RfcGlja19yZXNwb25zZSI6ICJhcnJheSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAicmVzdF9waWNrX2RlcHRoIjogIjEiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIF0KICAgICAgICB9CiAgICBdCn08P3BocAoKcG9kc19pbml0KCktPnNldHVwKCk7CnBvZHNfaW5pdCgpLT5sb2FkX2NvbXBvbmVudHMoKTsKcG9kc19jb21wb25lbnRzKCktPmdldF9jb21wb25lbnRzKCk7CnBvZHNfY29tcG9uZW50cygpLT5sb2FkKCk7CmlmICggISBjbGFzc19leGlzdHMoICdQb2RzX01pZ3JhdGVfUGFja2FnZXMnICkgKSB7CgkkX0dFVFsndG9nZ2xlJ10gPSAxOwoJcG9kc19jb21wb25lbnRzKCktPnRvZ2dsZSggJ21pZ3JhdGUtcGFja2FnZXMnICk7Cglwb2RzX2NvbXBvbmVudHMoKS0+bG9hZCgpOwp9Ci8qCmlmICggISBjbGFzc19leGlzdHMoICdQb2RzX0FkdmFuY2VkX1JlbGF0aW9uc2hpcHMnICkgKSB7CgkkX0dFVFsndG9nZ2xlJ10gPSAxOwoJcG9kc19jb21wb25lbnRzKCktPnRvZ2dsZSggJ2FkdmFuY2VkLXJlbGF0aW9uc2hpcHMnICk7Cglwb2RzX2NvbXBvbmVudHMoKS0+bG9hZCgpOwp9CiovCnBvZHNfYXBpKCktPmltcG9ydF9wYWNrYWdlKCBvYl9nZXRfY2xlYW4oKSApOwoKcG9kc19hcGkoKS0+Y2FjaGVfZmx1c2hfcG9kcygpOwppZiAoICEgZGVmaW5lZCggJ1BPRFNfUFJFTE9BRF9DT05GSUdfQUZURVJfRkxVU0gnICkgKSB7CglkZWZpbmUoICdQT0RTX1BSRUxPQURfQ09ORklHX0FGVEVSX0ZMVVNIJywgdHJ1ZSApOwp9CnBvZHNfYXBpKCktPmxvYWRfcG9kcygpOwo=' ).replace(/\n/g, ' ')
  });

  blueprint.steps.push({
		"step": "importFile",
		"file": {
			"url": "https://pd-cm.github.io/pods-demos/plugins/books.xml",
			"resource": "url"
		}
	});

	blueprint.steps.push({
  	"step": 'runPHP',
  	"code": atob( 'PD9waHAKCmluY2x1ZGUgJ3dvcmRwcmVzcy93cC1sb2FkLnBocCc7Cmdsb2JhbCAkd3BkYjsKCiRmcm9udF9wYWdlX2lkID0gJHdwZGItPmdldF92YXIoICJTRUxFQ1QgSUQgRlJPTSB7JHdwZGItPnByZWZpeH1wb3N0cyBXSEVSRSBwb3N0X3RpdGxlID0gJ0hvbWUnIiApOwoKdXBkYXRlX29wdGlvbigKCSdwYWdlX29uX2Zyb250JywKCSRmcm9udF9wYWdlX2lkCik7CnVwZGF0ZV9vcHRpb24oJ3Nob3dfb25fZnJvbnQnLCAncGFnZScpOwoKdXBkYXRlX29wdGlvbiggJ2Jsb2duYW1lJywgJ1BvZHM6IEJvb2tzIERlbW8nICk7CnVwZGF0ZV9vcHRpb24oICd3aXNkb21fYmxvY2tfbm90aWNlJywgWyAncG9kcycgPT4gJ3BvZHMnIF0gKTsKCgokd3BkYi0+dXBkYXRlKAoJJHdwZGItPnByZWZpeCAuICdwb3N0cycsCglbCgkJJ3Bvc3RfY29udGVudCcgPT4gc3RyX3JlcGxhY2UoCgkJCVsKCQkJCSdwb3N0PTInLAoJCQkJJ1ZpZXcgUG9kcyBEZWZpbml0aW9uJywKCQkJXSwKCQkJWwoJCQkJc3ByaW50ZiggJ3Bvc3Q9JWQnLCAkZnJvbnRfcGFnZV9pZCApLAoJCQkJJ1ZpZXcgUG9kcyBDb25maWd1cmF0aW9uJywKCQkJXSwKCQkJJHdwZGItPmdldF92YXIoIHNwcmludGYoICdTRUxFQ1QgcG9zdF9jb250ZW50IEZST00gJXNwb3N0cyBXSEVSRSBJRCA9ICVkJywgJHdwZGItPnByZWZpeCwgJGZyb250X3BhZ2VfaWQgKSApCgkJKSwKCV0sCglbICdJRCcgPT4gJGZyb250X3BhZ2VfaWQgXSwKCVsgJyVzJyBdLAoJWyAnJWQnIF0KKTsKCndwX2RlbGV0ZV9wb3N0KAoJJHdwZGItPmdldF92YXIoICJTRUxFQ1QgSUQgRlJPTSB7JHdwZGItPnByZWZpeH1wb3N0cyBXSEVSRSBwb3N0X3RpdGxlID0gJ1NhbXBsZSBQYWdlJyIgKSwKCXRydWUKKTsKCndwX3VwZGF0ZV91c2VyKCBbICdJRCcgPT4gMSwgJ2Rpc3BsYXlfbmFtZScgPT4gJ1BvZHMgQWRtaW4nIF0gKTs=' ).replace(/\n/g, ' ')
  });
  console.log( blueprint );
  const client = await startPlaygroundWeb({
    iframe: document.getElementById('wp'),
    remoteUrl: 'https://playground.wordpress.net/remote.html',
    blueprint: blueprint,
  });
</script>
</body></html>
